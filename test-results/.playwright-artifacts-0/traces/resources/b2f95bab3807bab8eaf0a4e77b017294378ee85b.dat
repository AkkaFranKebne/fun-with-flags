import { createHotContext as __vite__createHotContext } from "/@vite/client";import.meta.hot = __vite__createHotContext("/src/components/Map/Map.tsx");import __vite__cjsImport0_react_jsxDevRuntime from "/node_modules/.vite/deps/react_jsx-dev-runtime.js?v=b175f560"; const jsxDEV = __vite__cjsImport0_react_jsxDevRuntime["jsxDEV"];
import RefreshRuntime from "/@react-refresh";
const inWebWorker = typeof WorkerGlobalScope !== "undefined" && self instanceof WorkerGlobalScope;
let prevRefreshReg;
let prevRefreshSig;
if (import.meta.hot && !inWebWorker) {
  if (!window.__vite_plugin_react_preamble_installed__) {
    throw new Error("@vitejs/plugin-react can't detect preamble. Something is wrong. See https://github.com/vitejs/vite-plugin-react/pull/11#discussion_r430879201");
  }
  prevRefreshReg = window.$RefreshReg$;
  prevRefreshSig = window.$RefreshSig$;
  window.$RefreshReg$ = (type, id) => {
    RefreshRuntime.register(type, "/Users/ewa.wrobel/fun-with-maps/fun-with-maps/src/components/Map/Map.tsx " + id);
  };
  window.$RefreshSig$ = RefreshRuntime.createSignatureFunctionForTransform;
}
var _s2 = $RefreshSig$();
import __vite__cjsImport3_react from "/node_modules/.vite/deps/react.js?v=b175f560"; const useEffect = __vite__cjsImport3_react["useEffect"]; const useRef = __vite__cjsImport3_react["useRef"];
import H from "/node_modules/.vite/deps/@here_maps-api-for-javascript.js?v=b175f560";
import { coordinatesList } from "/src/utils/dataForMap.ts";
import { addInfoBubble, showBubbleOnMenuClick } from "/src/utils/addMapInfo.ts";
import "/src/components/Map/Map.scss";
import useElementSize from "/src/hooks/useElementSize.ts";
import { useMiddleCoordinate } from "/src/hooks/useMiddleCoordinate.ts";
import { useDoubleRadius } from "/src/hooks/useDoubleRadius.ts";
export const MyMap = (props) => {
  _s2();
  var _s = $RefreshSig$();
  const mapRef = useRef(null);
  const map = useRef(null);
  const platform = useRef(null);
  const uis = useRef(null);
  const { apikey, userPosition, mapPointPosition, mapPointsList } = props;
  const [boxRef, { width, height }] = useElementSize();
  _s(useEffect(
    _s(
      () => {
        _s();
        if (!map.current) {
          platform.current = new H.service.Platform({ apikey });
          const rasterTileService = platform.current.getRasterTileService({
            queryParams: {
              style: "explore.day",
              size: 512
            }
          });
          const rasterTileProvider = new H.service.rasterTile.Provider(
            rasterTileService
          );
          const rasterTileLayer = new H.map.layer.TileLayer(rasterTileProvider);
          const newMap = new H.Map(mapRef.current, rasterTileLayer, {
            pixelRatio: window.devicePixelRatio,
            center: userPosition,
            zoom: 14
          });
          const behavior = new H.mapevents.Behavior(
            new H.mapevents.MapEvents(newMap)
          );
          map.current = newMap;
          const ui = H.ui.UI.createDefault(newMap, rasterTileLayer);
          uis.current = ui;
          addInfoBubble({ map: newMap, ui, pointsData: mapPointsList, H });
          const circleCenterPosition = useMiddleCoordinate(coordinatesList);
          const circle = new H.map.Circle(circleCenterPosition, useDoubleRadius(coordinatesList, circleCenterPosition), {
            //@ts-ignore
            style: {
              fillColor: "rgba(255, 255, 255, 0.5)",
              strokeColor: "#829",
              lineWidth: 1
            }
          });
          newMap.addObject(circle);
          window.addEventListener("resize", function() {
            newMap.getViewPort().resize();
          });
        }
        if (mapPointPosition) {
          showBubbleOnMenuClick({ map: map.current, ui: uis.current, dataPoint: mapPointPosition });
        }
      },
      "tx6w+fP1tdid33elu5OUDAz89AE=",
      false,
      function() {
        return [useMiddleCoordinate, useDoubleRadius];
      }
    ),
    // Dependencies array
    [apikey, userPosition, mapPointPosition]
  ), "tx6w+fP1tdid33elu5OUDAz89AE=", false, function() {
    return [useMiddleCoordinate, useDoubleRadius];
  });
  useEffect(() => {
    if (map.current) {
      map.current.getViewPort().resize();
    }
  }, [width, height]);
  return /* @__PURE__ */ jsxDEV("div", { style: { width: "100%", height: "100%" }, ref: boxRef, children: /* @__PURE__ */ jsxDEV("div", { style: { width: "100%", height: "100%" }, ref: mapRef }, void 0, false, {
    fileName: "/Users/ewa.wrobel/fun-with-maps/fun-with-maps/src/components/Map/Map.tsx",
    lineNumber: 120,
    columnNumber: 70
  }, this) }, void 0, false, {
    fileName: "/Users/ewa.wrobel/fun-with-maps/fun-with-maps/src/components/Map/Map.tsx",
    lineNumber: 120,
    columnNumber: 10
  }, this);
};
_s2(MyMap, "Xe0P509IJtRx1eTn92dV20cYIyI=", false, function() {
  return [useElementSize];
});
_c = MyMap;
var _c;
$RefreshReg$(_c, "MyMap");
if (import.meta.hot && !inWebWorker) {
  window.$RefreshReg$ = prevRefreshReg;
  window.$RefreshSig$ = prevRefreshSig;
  RefreshRuntime.__hmr_import(import.meta.url).then((currentExports) => {
    RefreshRuntime.registerExportsForReactRefresh("/Users/ewa.wrobel/fun-with-maps/fun-with-maps/src/components/Map/Map.tsx", currentExports);
    import.meta.hot.accept((nextExports) => {
      if (!nextExports)
        return;
      const invalidateMessage = RefreshRuntime.validateRefreshBoundaryAndEnqueueUpdate(currentExports, nextExports);
      if (invalidateMessage)
        import.meta.hot.invalidate(invalidateMessage);
    });
  });
}

//# sourceMappingURL=data:application/json;base64,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ZCxxQkFDd0JDLGVBQWU7QUFBQTtBQUFBO0FBQUE7QUFBQSxJQTRCekUsQ0FBQ1csUUFBUUMsY0FBY0MsZ0JBQWdCO0FBQUEsRUFDekMsR0FBQztBQUFBLFlBOUJtQ2QscUJBQ3dCQyxlQUFlO0FBQUE7QUErQjNFUCxZQUFVLE1BQU07QUFDZCxRQUFJZSxJQUFJVSxTQUFTO0FBR2ZWLFVBQUlVLFFBQVFxQyxZQUFZLEVBQUVDLE9BQU87QUFBQSxJQUNuQztBQUFBLEVBQ0YsR0FBRyxDQUFDeEMsT0FBT0MsTUFBTSxDQUFDO0FBR2xCLFNBQU8sdUJBQUMsU0FBSSxPQUFRLEVBQUVELE9BQU8sUUFBUUMsUUFBUSxPQUFPLEdBQUksS0FBS0YsUUFBUyxpQ0FBQyxTQUFJLE9BQVEsRUFBRUMsT0FBTyxRQUFRQyxRQUFRLE9BQU8sR0FBSSxLQUFLWCxVQUF0RDtBQUFBO0FBQUE7QUFBQTtBQUFBLFNBQTZELEtBQTVIO0FBQUE7QUFBQTtBQUFBO0FBQUEsU0FBOEg7QUFHdEk7QUFBQ0gsSUF4R1dGLE9BQTBCO0FBQUEsVUFRREgsY0FBYztBQUFBO0FBQUE0RCxLQVJ2Q3pEO0FBQTBCLElBQUF5RDtBQUFBQyxhQUFBRCxJQUFBIiwibmFtZXMiOlsidXNlRWZmZWN0IiwiSCIsImNvb3JkaW5hdGVzTGlzdCIsImFkZEluZm9CdWJibGUiLCJzaG93QnViYmxlT25NZW51Q2xpY2siLCJ1c2VFbGVtZW50U2l6ZSIsInVzZU1pZGRsZUNvb3JkaW5hdGUiLCJ1c2VEb3VibGVSYWRpdXMiLCJNeU1hcCIsInByb3BzIiwiX3MyIiwiX3MiLCIkUmVmcmVzaFNpZyQiLCJtYXBSZWYiLCJ1c2VSZWYiLCJtYXAiLCJwbGF0Zm9ybSIsInVpcyIsImFwaWtleSIsInVzZXJQb3NpdGlvbiIsIm1hcFBvaW50UG9zaXRpb24iLCJtYXBQb2ludHNMaXN0IiwiYm94UmVmIiwid2lkdGgiLCJoZWlnaHQiLCJjdXJyZW50Iiwic2VydmljZSIsIlBsYXRmb3JtIiwicmFzdGVyVGlsZVNlcnZpY2UiLCJnZXRSYXN0ZXJUaWxlU2VydmljZSIsInF1ZXJ5UGFyYW1zIiwic3R5bGUiLCJzaXplIiwicmFzdGVyVGlsZVByb3ZpZGVyIiwicmFzdGVyVGlsZSIsIlByb3ZpZGVyIiwicmFzdGVyVGlsZUxheWVyIiwibGF5ZXIiLCJUaWxlTGF5ZXIiLCJuZXdNYXAiLCJNYXAiLCJwaXhlbFJhdGlvIiwid2luZG93IiwiZGV2aWNlUGl4ZWxSYXRpbyIsImNlbnRlciIsInpvb20iLCJiZWhhdmlvciIsIm1hcGV2ZW50cyIsIkJlaGF2aW9yIiwiTWFwRXZlbnRzIiwidWkiLCJVSSIsImNyZWF0ZURlZmF1bHQiLCJwb2ludHNEYXRhIiwiY2lyY2xlQ2VudGVyUG9zaXRpb24iLCJjaXJjbGUiLCJDaXJjbGUiLCJmaWxsQ29sb3IiLCJzdHJva2VDb2xvciIsImxpbmVXaWR0aCIsImFkZE9iamVjdCIsImFkZEV2ZW50TGlzdGVuZXIiLCJnZXRWaWV3UG9ydCIsInJlc2l6ZSIsImRhdGFQb2ludCIsIl9jIiwiJFJlZnJlc2hSZWckIl0sImlnbm9yZUxpc3QiOltdLCJzb3VyY2VzIjpbIk1hcC50c3giXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFJlYWN0LCB7IHVzZUVmZmVjdCwgdXNlUmVmIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IEggZnJvbSAnQGhlcmUvbWFwcy1hcGktZm9yLWphdmFzY3JpcHQnO1xuaW1wb3J0IHsgTWFwUG9pbnRUeXBlLCBQb3NpdGlvbiwgY29vcmRpbmF0ZXNMaXN0IH0gZnJvbSAnLi4vLi4vdXRpbHMvZGF0YUZvck1hcCc7XG5pbXBvcnQgeyBhZGRJbmZvQnViYmxlLCBzaG93QnViYmxlT25NZW51Q2xpY2sgfSBmcm9tICcuLi8uLi91dGlscy9hZGRNYXBJbmZvJztcbmltcG9ydCAnLi9NYXAuc2NzcydcbmltcG9ydCB1c2VFbGVtZW50U2l6ZSBmcm9tICcuLi8uLi9ob29rcy91c2VFbGVtZW50U2l6ZSc7XG5pbXBvcnQgeyB1c2VNaWRkbGVDb29yZGluYXRlIH0gZnJvbSAnLi4vLi4vaG9va3MvdXNlTWlkZGxlQ29vcmRpbmF0ZSc7XG5pbXBvcnQgeyB1c2VEb3VibGVSYWRpdXMgfSBmcm9tICcuLi8uLi9ob29rcy91c2VEb3VibGVSYWRpdXMnO1xuXG5leHBvcnQgdHlwZSBNeU1hcFR5cGUgPSB7XG4gIGFwaWtleTogc3RyaW5nO1xuICB1c2VyUG9zaXRpb246IFBvc2l0aW9uO1xuICBtYXBQb2ludFBvc2l0aW9uOiBNYXBQb2ludFR5cGUgfCBudWxsO1xuICBtYXBQb2ludHNMaXN0OiBNYXBQb2ludFR5cGVbXTtcbn1cblxuXG5cbmV4cG9ydCBjb25zdCBNeU1hcDogUmVhY3QuRkM8TXlNYXBUeXBlPiA9IChwcm9wcykgPT4ge1xuICBjb25zdCBtYXBSZWYgPSB1c2VSZWY8SFRNTElucHV0RWxlbWVudCB8IG51bGw+KG51bGwpO1xuICBjb25zdCBtYXAgPSB1c2VSZWY8SFRNTElucHV0RWxlbWVudCB8IG51bGw+KG51bGwpO1xuICBjb25zdCBwbGF0Zm9ybSA9IHVzZVJlZjxIVE1MSW5wdXRFbGVtZW50IHwgbnVsbD4obnVsbClcbiAgY29uc3QgdWlzID0gdXNlUmVmPEhUTUxJbnB1dEVsZW1lbnQgfCBudWxsPihudWxsKVxuICBjb25zdCB7IGFwaWtleSwgdXNlclBvc2l0aW9uLCBtYXBQb2ludFBvc2l0aW9uLCBtYXBQb2ludHNMaXN0ICB9ID0gcHJvcHM7XG4gIFxuICAvLyBvYnNlcnZpbmcgdGhlIG1hcCdzIGRpdiBzaXplXG4gIGNvbnN0IFtib3hSZWYsIHsgd2lkdGgsIGhlaWdodCB9XSA9IHVzZUVsZW1lbnRTaXplKCk7XG5cbiAgdXNlRWZmZWN0KFxuICAgICgpID0+IHtcbiAgICAgIC8vIENoZWNrIGlmIHRoZSBtYXAgb2JqZWN0IGhhcyBhbHJlYWR5IGJlZW4gY3JlYXRlZFxuICAgICAgaWYgKCFtYXAuY3VycmVudCkge1xuICAgICAgICAvLyBDcmVhdGUgYSBwbGF0Zm9ybSBvYmplY3Qgd2l0aCB0aGUgQVBJIGtleVxuICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgcGxhdGZvcm0uY3VycmVudCA9IG5ldyBILnNlcnZpY2UuUGxhdGZvcm0oeyBhcGlrZXkgfSk7XG4gICAgICAgIC8vIENyZWF0ZSBhIG5ldyBSYXN0ZXIgVGlsZSBzZXJ2aWNlIGluc3RhbmNlXG4gICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgY29uc3QgcmFzdGVyVGlsZVNlcnZpY2UgPSBwbGF0Zm9ybS5jdXJyZW50LmdldFJhc3RlclRpbGVTZXJ2aWNlKHtcbiAgICAgICAgICBxdWVyeVBhcmFtczoge1xuICAgICAgICAgICAgc3R5bGU6IFwiZXhwbG9yZS5kYXlcIixcbiAgICAgICAgICAgIHNpemU6IDUxMixcbiAgICAgICAgICB9LFxuICAgICAgICB9KTtcbiAgICAgICAgLy8gQ3JlYXRlcyBhIG5ldyBpbnN0YW5jZSBvZiB0aGUgSC5zZXJ2aWNlLnJhc3RlclRpbGUuUHJvdmlkZXIgY2xhc3NcbiAgICAgICAgLy8gVGhlIGNsYXNzIHByb3ZpZGVzIHJhc3RlciB0aWxlcyBmb3IgYSBnaXZlbiB0aWxlIGxheWVyIElEIGFuZCBwaXhlbCBmb3JtYXRcbiAgICAgICAgY29uc3QgcmFzdGVyVGlsZVByb3ZpZGVyID0gbmV3IEguc2VydmljZS5yYXN0ZXJUaWxlLlByb3ZpZGVyKFxuICAgICAgICAgIHJhc3RlclRpbGVTZXJ2aWNlXG4gICAgICAgICk7XG4gICAgICAgIC8vIENyZWF0ZSBhIG5ldyBUaWxlIGxheWVyIHdpdGggdGhlIFJhc3RlciBUaWxlIHByb3ZpZGVyXG4gICAgICAgIGNvbnN0IHJhc3RlclRpbGVMYXllciA9IG5ldyBILm1hcC5sYXllci5UaWxlTGF5ZXIocmFzdGVyVGlsZVByb3ZpZGVyKTtcbiAgICAgICAgLy8gQ3JlYXRlIGEgbmV3IG1hcCBpbnN0YW5jZSB3aXRoIHRoZSBUaWxlIGxheWVyLCBjZW50ZXIgYW5kIHpvb20gbGV2ZWxcbiAgICAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgICBjb25zdCBuZXdNYXAgPSBuZXcgSC5NYXAobWFwUmVmLmN1cnJlbnQsIHJhc3RlclRpbGVMYXllciwge1xuICAgICAgICAgIHBpeGVsUmF0aW86IHdpbmRvdy5kZXZpY2VQaXhlbFJhdGlvLFxuICAgICAgICAgIGNlbnRlcjogdXNlclBvc2l0aW9uLFxuICAgICAgICAgIHpvb206IDE0LFxuICAgICAgICB9KTtcbiAgXG4gICAgICAgIC8vIEFkZCBwYW5uaW5nIGFuZCB6b29taW5nIGJlaGF2aW9yIHRvIHRoZSBtYXBcbiAgICAgICAgLy9AdHMtaWdub3JlXG4gICAgICAgIGNvbnN0IGJlaGF2aW9yID0gbmV3IEgubWFwZXZlbnRzLkJlaGF2aW9yKFxuICAgICAgICAgIG5ldyBILm1hcGV2ZW50cy5NYXBFdmVudHMobmV3TWFwKVxuICAgICAgICApO1xuXG4gICAgICAgIC8vIFNldCB0aGUgbWFwIG9iamVjdCB0byB0aGUgcmVmZXJlbmNlXG4gICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgbWFwLmN1cnJlbnQgPSBuZXdNYXA7XG5cbiAgICAgICAgLy8gQ3JlYXRlIHRoZSBkZWZhdWx0IFVJOlxuICAgICAgICBjb25zdCB1aSA9IEgudWkuVUkuY3JlYXRlRGVmYXVsdChuZXdNYXAsIHJhc3RlclRpbGVMYXllcik7XG4gICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgdWlzLmN1cnJlbnQgPSB1aTtcblxuICAgICAgICAvLyBhZGRpbmcgYnViYmxlIGluZm9cbiAgICAgICAgYWRkSW5mb0J1YmJsZSh7bWFwOiBuZXdNYXAsIHVpLCBwb2ludHNEYXRhOiBtYXBQb2ludHNMaXN0LCBIfSk7XG5cbiAgICAgICAgLy8gYWRkaW5nIGNpcmNsZVxuXG4gICAgICAgIGNvbnN0IGNpcmNsZUNlbnRlclBvc2l0aW9uID0gIHVzZU1pZGRsZUNvb3JkaW5hdGUoY29vcmRpbmF0ZXNMaXN0KTtcbiAgICAgICAgY29uc3QgY2lyY2xlID0gbmV3IEgubWFwLkNpcmNsZShjaXJjbGVDZW50ZXJQb3NpdGlvbiwgdXNlRG91YmxlUmFkaXVzKGNvb3JkaW5hdGVzTGlzdCwgY2lyY2xlQ2VudGVyUG9zaXRpb24pLCB7XG4gICAgICAgICAgLy9AdHMtaWdub3JlXG4gICAgICAgICAgc3R5bGU6IHtcbiAgICAgICAgICAgIGZpbGxDb2xvcjogJ3JnYmEoMjU1LCAyNTUsIDI1NSwgMC41KScsXG4gICAgICAgICAgICBzdHJva2VDb2xvcjogJyM4MjknLFxuICAgICAgICAgICAgbGluZVdpZHRoOiAxXG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgbmV3TWFwLmFkZE9iamVjdChjaXJjbGUpO1xuXG4gICAgICAgIC8vIGFkZCBwb2x5Z29uIFxuICAgICAgICAvL2FkZFBvbHlnb25Ub01hcChuZXdNYXApO1xuXG5cbiAgICAgICAgLy8gcmVzaXplIG1hcCBvbiB3aW5kb3cgcmVzaXplXG4gICAgICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgbmV3TWFwLmdldFZpZXdQb3J0KCkucmVzaXplKCk7IFxuICAgICAgICB9KTtcblxuICAgICAgfVxuXG4gICAgICBpZiAobWFwUG9pbnRQb3NpdGlvbikge1xuICAgICAgICAvL2NhbGN1bGF0ZVJvdXRlKHBsYXRmb3JtLmN1cnJlbnQsIG1hcC5jdXJyZW50LCB1c2VyUG9zaXRpb24sIG1hcFBvaW50UG9zaXRpb24pO1xuICAgICAgICBzaG93QnViYmxlT25NZW51Q2xpY2soe21hcDogbWFwLmN1cnJlbnQsIHVpOiB1aXMuY3VycmVudCwgZGF0YVBvaW50OiBtYXBQb2ludFBvc2l0aW9ufSk7XG4gICAgfSBcblxuICAgIH0sXG4gICAgLy8gRGVwZW5kZW5jaWVzIGFycmF5XG4gICAgW2FwaWtleSwgdXNlclBvc2l0aW9uLCBtYXBQb2ludFBvc2l0aW9uXVxuICApO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgaWYgKG1hcC5jdXJyZW50KSB7XG4gICAgICAvLyByZXNpemluZyBtYXAgb24gZGl2IHNpemUgY2hhbmdlXG4gICAgICAvL0B0cy1pZ25vcmVcbiAgICAgIG1hcC5jdXJyZW50LmdldFZpZXdQb3J0KCkucmVzaXplKCk7IFxuICAgIH1cbiAgfSwgW3dpZHRoLCBoZWlnaHRdKTtcbiAgXG4gIC8vIFJldHVybiBhIGRpdiBlbGVtZW50IHRvIGhvbGQgdGhlIG1hcFxuICByZXR1cm4gPGRpdiBzdHlsZT17IHsgd2lkdGg6IFwiMTAwJVwiLCBoZWlnaHQ6IFwiMTAwJVwiIH0gfSByZWY9e2JveFJlZn0gPjxkaXYgc3R5bGU9eyB7IHdpZHRoOiBcIjEwMCVcIiwgaGVpZ2h0OiBcIjEwMCVcIiB9IH0gcmVmPXttYXBSZWZ9Lz48L2Rpdj47XG5cbiAgXG4gfSJdLCJmaWxlIjoiL1VzZXJzL2V3YS53cm9iZWwvZnVuLXdpdGgtbWFwcy9mdW4td2l0aC1tYXBzL3NyYy9jb21wb25lbnRzL01hcC9NYXAudHN4In0=